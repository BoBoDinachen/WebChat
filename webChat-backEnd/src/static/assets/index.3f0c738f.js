var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,n=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,l=(e,l)=>{for(var r in l||(l={}))t.call(l,r)&&n(e,r,l[r]);if(a)for(var r of a(l))s.call(l,r)&&n(e,r,l[r]);return e},r=(e,t,a)=>(n(e,"symbol"!=typeof t?t+"":t,a),a);import{i as o,F as c,N as i,w as m,a as u,S as h,R as p,b as g,c as d,B as E}from"./vendor.aace8ec4.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,l)=>{const r=new URL(e,s);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const o=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){l(new Error(`Failed to import: ${e}`)),n(c)},onload(){a(self[t].moduleMap[r]),n(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("assets/");var _={currSocket:null,createSocket:function(e){const t=o("http://172.21.231.28:5000",{path:"/WebChat/chat"});return this.currSocket=t,t.emit("online",{uid:e}),t},closeSocket:function(e){this.currSocket.emit("closeSocket",e)},openSocket:function(e){this.currSocket.open(),this.currSocket.emit("online",{uid:e})},privateChat:function(e){this.currSocket.emit("private_chat",e)}};var S="_footer_yfnzb_2",I="_navList_yfnzb_10",k="_increment_yfnzb_19";var f="_list_item_j4dkq_1",A="_link_j4dkq_5",w="_active_j4dkq_15";class v extends c.Component{render(){return this.props,c.createElement("li",{className:f},c.createElement(i,l(l({},this.props),{activeClassName:w,className:A})))}}class b extends c.Component{constructor(){super(...arguments),r(this,"goToShare",(()=>{const{replace:e}=this.props.history;e("/share")}))}render(){return c.createElement(c.Fragment,null,c.createElement("footer",{className:S},c.createElement("span",{className:k,onTouchEnd:this.goToShare}),c.createElement("ul",{className:I},[{id:"001",path:"/home",name:"大厅"},{id:"002",path:"/friends",name:"好友"},{id:"003",path:"/share",name:""},{id:"004",path:"/message",name:"消息"},{id:"005",path:"/profile",name:"我的"}].map(((e,t)=>c.createElement(v,{to:e.path,children:e.name,key:e.id}))))))}}var C=m(b);var y="_title_8u8h3_2",N="_back_8u8h3_10";class B extends c.Component{constructor(){super(...arguments),r(this,"handleBack",(()=>{const{goBack:e}=this.props.history;e()}))}componentDidMount(){}render(){let e="";const{pathname:t}=this.props.location;switch(t){case"/home":e="大厅";break;case"/profile":e="个人中心";break;case"/friends":e="我的好友";break;case"/message":e="我的消息";break;case"/message/friendMsg":e="好友消息";break;case"/message/likeMsg":e="收到的喜欢";break;case"/message/tagsMsg":e="收到的点赞"}return c.createElement("header",null,c.createElement("h2",{className:y},c.createElement("span",{className:N,onTouchEnd:this.handleBack}),e))}}var M=m(B);var x="_container_12qq5_2",Q="_showInfo_12qq5_11",J="_recordList_12qq5_82",R="_menuList_12qq5_116",L="_backLogin_12qq5_174",O="_input_box_12qq5_189";var T="_btn_x4jb1_1";function j(e){const{type:t}=e;let a={backgroundColor:""};switch(t){case"success":a.backgroundColor="#009966";break;case"primary":a.backgroundColor="#FF6666";break;default:a.backgroundColor="#99CC99"}return c.createElement("a",{className:T,style:a,onTouchEnd:e.click},e.children)}var Z="_messageBox_137n3_1",U="_content_137n3_21",G="_close_137n3_24";function H(e){const{type:t,time:a,text:s,position:n,isShow:l}=e,r=c.useRef(null);function o(){r.current.style.transform="translateY(-200%)"}return c.useEffect((()=>{l&&(r.current.style.transform="none",setTimeout((()=>{o()}),a))})),c.createElement("div",{className:Z,ref:r},c.createElement("img",{src:"./assets/正确.b816c77b.png"}),c.createElement("div",{className:U},c.createElement("h3",null,"success"===t?"成功":"失败"),c.createElement("p",null,s)),c.createElement("img",{className:G,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAKZElEQVR4Xu2dvc+mQxSHf0p6ISoKFQWxm0gUKvwF1CTCJhvV+i82dBIkQikkekqJQuKzUGlEt6tGScY+r33ffZ+PuWfO3PeZc663NXPuc65zLvN8TPa5T/xBAAIHCdwHGwhA4DABBGE6IHCEAIIwHhBAEGYAAm0EOEHauLErCQEESdJoymwjgCBt3NiVhACCJGk0ZbYRQJA2buxKQgBBkjSaMtsIIEgbN3YlIYAgSRpNmW0EEKSNG7uSEECQJI2mzDYCCNLGjV1JCCBIkkZTZhsBBGnjxq4kBBAkSaMps40AgrRxY1cSAgiSpNGU2UYAQdq4sSsJAQRJ0mjKbCOAIG3c2JWEAIIkaTRlthFAkDZu7EpCAEGSNJoy2wggSBs3diUhgCBJGk2ZbQQQpI0bu5IQQJAkjabMNgII0saNXUkIzCLIM5J+l/RHkr5EL/MhSY9I+tF7oV4FeVTSW5KuSLoq6f4dyJ8kfSvpC0lfeYdLfhcIvCjpFUnPSnpi91/+kvSNpJ8lfSrpe2/MPAryqqSPK0B9IOkdSb9WrGXJdgQel3RD0psVKXxYua4ilM0Sb4L8s7Cs8pLruqTPF+5j+ToEXpb0nqQHFz7OzVy6SURSORHeWAjybHk5upGkEd6gbUWOzxpjvybpk8a9ptu8CFLehH/XWRmSdAI03N4jx1kaj0n6zTCnplBeBLkp6e2mCi5uQhIDiJ0hLOQoKby7e+/SmU7fdi+ClE+kXugr5f/dSGIEsiGMlRzl0V9Ler4hB9MtXgT5U9IDhpUhiSHMylCWcpRH/m08E5VlXFzmQZCnJf3QlP3xTUgyAOqBkNZynD2mfA+26XcjHgQpHwHeHtRLJBkE9lzYUXKURzws6db4Eg4/wYMgJbty5eCpQSCQZBBYSSPl+EXSk+NSr4vsRZD3B3+DiiR187Bk1Ug5Sh4fSXp9SUIj1noRpNzT+XJEgediIokd4NFylExf8nDfzosgBcjoU6Q8A0n6JVlDjnKr4lp/qv0RPAlSLrWVm51L7+0spYAkS4ndXb+GHOV+3XNeLqF6EqS0YY0GcJK0CZKyN94EQZK24R29K6UcBapHQZBk9Lgvi59WDs+CIMmyIR61OrUc3gVBklFjXxc3vRwzCIIkdcNsvQo5dkS9vge5t+E0zFqBw/FgfY7NLIJwkqwjCHLcw3kmQZBkrCTIsYfvbIIgyRhJkOMA1xkFQRJbSZDjCM9ZBUESG0mQ4wTHmQVBkj5JkKOC3+yCIElFk/csQY5KbhEEQZLKZu+WIccCXlEEQZK6piNHHaf/V0USBEmONx85FspRlkcTBEn2DwFyNMgRVRAkuTgMyNEoR2RBkOTOUCBHhxzRBck+IMjRKUcGQbJKghwGcmQRJJskyGEkRyZBskiCHIZyZBMkuiTIYSxHRkGiSoIcA+TIKkg0SZBjkByZBYkiCXIMlCO7ILNLghyD5UCQeb9tRo4V5ECQu5BnGriZcl1pjMc9JuJt3lZaMwzeDDm28ne5D0EutsXzAHrOzeVwWySFIJcpehxEjzlZzJ/7GAiyv0WeBtJTLu4H2jpBBDlM1MNgesjBeuamiocgx9u15YBu+eyphnhksghymu4Wg7rFM0+TSLgCQeqavubAlow+q0uraxU/h12BD0EqIO2WrCVJfUbtK5Gjkh2CVIIKJAlyLOg5giyAFUAS5FjYbwRZCGxiSZCjodcI0gBtQkmQo7HPCNIIbiJJkKOjxwjSAW8CSZCjs78I0gnQsSTIYdBbBDGA6FAS5DDqK4IYgXQkCXIY9hRBDGE6kAQ5jPuJIMZAN5QEOQb0EkEGQN1AEuQY1EcEGQR2xR+vKRUgyKA+IsgYsFvc/EWSAb1EEHuoW8hxVgWSGPcTQWyBbikHktj28r9oCGIH1YMcSGLXTwQxZOlJDiQxbCwnSD9Mj3IgSX9fOUEMGHqWA0kMGswJ0g5xBjmQpL2/nCAd7GaSA0k6Gs0JshzejHIgyfI+c4I0MJtZDiRpaDgnSD20CHIgSX2/OUEWsFpLjnJVpPzxT48uaM7IpZwgp+muKcfnu3S2eOZpEglXIMjxpm85qFs+O6EK+0tGkMOj4GFAPeSQWhYE2d9+T4PpKZd0siDI5ZZ7HEiPOaWQBUEuttnzIHrOLawsCHK3tTMM4Aw5hpIFQe60c6bBmynX6WVBkLnkOBs4JFlJveyCzDxoM+e+0nj3PyazIBEGLEIN/VM8MEJWQSINVqRaBo56W+iMgkQcqIg1tU208a5sgkQepMi1GY99fbhMgmQYoAw11k+3wcosgmQanEy1GihwPEQGQTIOTMaah8gSXZDMg5K5djNZIgvCgMx5S8BsuC0CRRUEOea6hGkxy0NiRBQEOS6PCkwa9YkmCINweBBg0yBJJEEYgNMDAKPTjC6siCIIja9vPKzqWYX4hSkavqDhu6Uwq2Q2+wlCoysbvWcZ7CrYzSwIDa5o8IklMDwBaFZBaGy/HGcRYHmE5YyC0FA7OZAk2AmCHPZyIEmQEwQ5xsmBJAfYzvISCznGy4EkexjPIAhyrCcHktzD2rsgyLG+HEhyjrlnQZBjOzmQZEfAqyDIsb0cSCK5vIuFHH7kSC+JtxMEOfzJkVoST4I8LukbSQ8OnpHyU8tnvyY7+FHhwq/xP7A/JD0n6VcP9DwJ8r6kNwdDQY5+wGtI8oGka/2p9kfwIsiLkr7sL+doBOSwA7yGJC9J+sou5bZIXgQZfXogR9t8HNs1WpKPJL1un/ayiF4E+VHSU8tSr16NHNWoFi8cKckvkp5cnJHxBg+ClDflt43rOguHHIPAngs7UpKHJd0aX8LhJ3gQ5GlJPwyAgBwDoB4IOUqSK5K+X6+My0/yIEjJ6k9JDxiCQA5DmJWhrCX523gmKsu4uMyLIOXTiheaKri8CTmMQDaEsZTka0nPN+RgusWLIDclvW1QGXIYQOwMYSXJu5JudObSvd2LIM9I+q6zGuToBGi43UKSxyT9ZphTUygvgpTky7enbzRVISFHI7iB23okeU3SJwNzqw7tSZCS9D/Vmd9ZWO7tXOdu1UJq6y0vkrzXcL/OzVy6SeRcz16V9HFFD8uJ846XS20V+WZdUi6hlvcSNffsPqxctxpLj4KU4h+V9Jak8jn4VUn374j8JOlbSV94uKezWpdiPKjctysvhZ+V9MSupL92N7h/lvTp1t957MPsVZB7cy1v4n/fvaSKMS65q3hI0iOSyhUj13+zCOIaIsnFJYAgcXtLZQYEEMQAIiHiEkCQuL2lMgMCCGIAkRBxCSBI3N5SmQEBBDGASIi4BBAkbm+pzIAAghhAJERcAggSt7dUZkAAQQwgEiIuAQSJ21sqMyCAIAYQCRGXAILE7S2VGRBAEAOIhIhLAEHi9pbKDAggiAFEQsQlgCBxe0tlBgQQxAAiIeISQJC4vaUyAwIIYgCREHEJIEjc3lKZAQEEMYBIiLgEECRub6nMgACCGEAkRFwCCBK3t1RmQABBDCASIi4BBInbWyozIIAgBhAJEZcAgsTtLZUZEEAQA4iEiEsAQeL2lsoMCPwLv5f22GMXzdkAAAAASUVORK5CYII=",onTouchEnd:o}))}function D(e){return u.create({baseURL:"http://172.21.231.28:5000/WebChat"})(e)}class z extends c.Component{constructor(){super(...arguments),r(this,"userInfo",JSON.parse(sessionStorage.getItem("user_info"))),r(this,"state",{user:{uid:this.userInfo._id,account:this.userInfo.account,user_name:this.userInfo.user_name,age:this.userInfo.age,sex:this.userInfo.sex,avatar_url:this.userInfo.avatar_url},showSetName:!1,showMessageSetAvatar:!1,showMessageSetName:!1}),r(this,"HandleAvatar",(()=>{alert("喵呜~")})),r(this,"uploadAvatar",(()=>{const e=this.uploadElem.files[0];if(console.log(e),("image/jpeg"===e.type||"image/png"===e.type)&&e.size<=2e6){const{user:t}=this.state,a=new FormData;a.append("avatar",e),a.append("uid",t.uid),confirm("确定选择这张头像吗")&&D({url:"/user/upload/profile",method:"post",headers:{"Content-Type":"multipart/form-data"},data:a}).then((e=>{if(console.log(e.data),e.data.setAvatar){this.openMessageSetAvatarBox();let t=JSON.parse(window.sessionStorage.getItem("user_info"));t.avatar_url=e.data.url,window.sessionStorage.setItem("user_info",JSON.stringify(t)),setTimeout((()=>{this.setState({user:{uid:t._id,account:t.account,user_name:t.user_name,age:t.age,sex:t.sex,avatar_url:e.data.url}})}),500)}})).catch((e=>{console.log(e)}))}else alert("请选择jpg或者png格式的图片,并且不大于2MB噢~")})),r(this,"setUserName",(()=>{const e=this.inputNameElem.value;""===e?alert("没有输入~"):D({url:"/user/profile/setName",method:"post",data:{uid:this.state.user.uid,user_name:e}}).then((e=>{const{isSet:t,user_name:a}=e.data;if(t){this.openMessageSetNameBox();const e=JSON.parse(window.sessionStorage.getItem("user_info"));e.user_name=a,window.sessionStorage.setItem("user_info",JSON.stringify(e)),this.setState({user:{uid:e._id,account:e.account,user_name:a,age:e.age,sex:e.sex,avatar_url:e.avatar_url}})}else alert("设置失败!")})).catch((e=>{console.log(e)}))})),r(this,"backLogin",(()=>{const{_id:e,account:t}=this.userInfo;setTimeout((()=>{confirm("确定要退出吗?")&&(_.closeSocket(e),window.localStorage.setItem("user_login",JSON.stringify({_id:e,account:t,password:""})),window.sessionStorage.clear(),window.location.reload())}),200)})),r(this,"openPopup",(()=>{setTimeout((()=>{this.setState({showSetName:!0,showMessageSetAvatar:!1,showMessageSetName:!1})}),200)}))}componentDidUpdate(e,t){console.log("Profile组件更新...");const{user:a}=this.state;""!==a.avatar_url&&this.getAvatar(a.uid)}componentDidMount(){console.log("Profile组件加载...");const e=JSON.parse(window.sessionStorage.getItem("user_info"));""!==e.avatar_url?this.setState({user:{uid:e._id,account:e.account,user_name:e.user_name,age:e.age,sex:e.sex,avatar_url:e.avatar_url}}):this.setState({user:{uid:e._id,account:e.account,user_name:e.user_name,age:e.age,sex:e.sex,avatar_url:""}},(()=>{this.avatarElem.src="./assets/默认头像.fcaee429.png"}))}getAvatar(e){D({url:"/user/avatar",method:"get",params:{uid:e},responseType:"blob"}).then((e=>{const t=window.URL.createObjectURL(e.data);this.avatarElem.src=t})).catch((e=>{console.log(e)}))}openMessageSetAvatarBox(){this.setState({showSetName:!1,showMessageSetName:!1,showMessageSetAvatar:!0})}openMessageSetNameBox(){this.setState({showSetName:!1,showMessageSetAvatar:!1,showMessageSetName:!0})}render(){const{user:e}=this.state,t=(a=c.createElement(c.Fragment,null,c.createElement("input",{ref:e=>{this.inputNameElem=e},type:"text",className:O,placeholder:"输入你的新名字吧..."}),c.createElement(j,{type:"success",click:this.setUserName},"确定修改")),class extends c.Component{constructor(){super(...arguments),r(this,"state",{}),r(this,"colsePopup",(()=>{this.popupBox.style.display="none"})),r(this,"openPopup",(()=>{this.popupBox.style.display="flex"}))}componentDidMount(){const{showPopup:e}=this.props;e&&this.openPopup()}render(){return c.createElement("div",{ref:e=>{this.popupBox=e},className:"_popup_1mm8y_1"},c.createElement("div",{className:"_content_1mm8y_17"},a),c.createElement("a",{className:"_close_1mm8y_23",onTouchEnd:this.colsePopup},c.createElement("img",{src:"./assets/关闭.cfdf8fd4.png"})))}});var a;return c.createElement("div",null,c.createElement(H,{time:"1500",text:"头像设置成功...",type:"success",isShow:this.state.showMessageSetAvatar}),c.createElement(H,{time:"1500",text:"设置昵称成功...",type:"success",isShow:this.state.showMessageSetName}),c.createElement(t,{showPopup:this.state.showSetName}),c.createElement("div",{className:x},c.createElement("div",{className:Q},c.createElement("span",{onTouchEnd:this.HandleUpload},c.createElement("input",{type:"file",ref:e=>{this.uploadElem=e},onChange:this.uploadAvatar})),c.createElement("img",{ref:e=>{this.avatarElem=e},alt:"",onTouchEnd:this.HandleAvatar}),c.createElement("span",null,""===e.user_name?e.account:e.user_name),c.createElement("label",null,c.createElement("img",{src:"男"===e.sex?"./assets/性别男.4b7d9a44.png":"./assets/性别女.febc19db.png"})," ",e.age,"岁"),c.createElement("p",null,"喜欢音乐、游戏、编程、美食爱好者")),c.createElement("ul",{className:J},c.createElement("li",null,111,c.createElement("label",null,"喜欢")),c.createElement("li",null,222,c.createElement("label",null,"共发消息")),c.createElement("li",null,333,c.createElement("label",null,"点赞"))),c.createElement("ul",{className:R},c.createElement("li",{onTouchEnd:this.openPopup},c.createElement("span",null),"设置昵称"),c.createElement("li",null,c.createElement("span",null),"编辑资料"),c.createElement("li",null,c.createElement("span",null),"设置背景"),c.createElement("li",null,c.createElement("span",null),"修改密码")),c.createElement("button",{className:L,onTouchEnd:this.backLogin},"退出登录")))}}class q extends c.Component{render(){return c.createElement("div",null,c.createElement("h2",null,"这是好友列表..."))}}var K="_container_1d28m_2",F="_messageTitle_1d28m_10",Y="_titleItem_1d28m_18",P="_titleItem3_1d28m_18",W="_titleItem2_1d28m_18",X="_active_1d28m_41";var V="_messageList_5m7z1_1";class $ extends c.Component{render(){return c.createElement("ul",{className:V},c.createElement("li",null,"这是好友信息列表"))}}var ee="_messageList_5m7z1_1";class te extends c.Component{render(){return c.createElement("ul",{className:ee},c.createElement("li",null,"这是收到的喜欢列表"))}}var ae="_messageList_5m7z1_1";class se extends c.Component{render(){return c.createElement("ul",{className:ae},c.createElement("li",null,"这是收到的点赞列表"))}}class ne extends c.Component{constructor(){super(...arguments),r(this,"uid",JSON.parse(sessionStorage.user_info)._id),r(this,"state",{currentIndex:"title1"})}componentDidMount(){this.props.history.push("/message/friendMsg")}handelChange(e){switch(e){case"item1":this.setState({currentIndex:"title1"},(()=>{this.props.history.push("/message/friendMsg")}));break;case"item2":this.setState({currentIndex:"title2"},(()=>{this.props.history.push("/message/likeMsg")}));break;case"item3":this.setState({currentIndex:"title3"},(()=>{this.props.history.push("/message/tagsMsg")}))}}render(){return c.createElement("div",{className:K},c.createElement("div",{className:F},c.createElement("div",{className:`${Y} ${"title1"===this.state.currentIndex?X:null}`},c.createElement("span",{onTouchEnd:this.handelChange.bind(this,"item1")})),c.createElement("div",{className:`${W} ${"title2"===this.state.currentIndex?X:null}`},c.createElement("span",{onTouchEnd:this.handelChange.bind(this,"item2")})),c.createElement("div",{className:`${P} ${"title3"===this.state.currentIndex?X:null}`},c.createElement("span",{onTouchEnd:this.handelChange.bind(this,"item3")}))),c.createElement(h,null,c.createElement(p,{path:"/message/friendMsg",component:$}),c.createElement(p,{path:"/message/likeMsg",component:te}),c.createElement(p,{path:"/message/tagsMsg",component:se})))}}var le=m(ne);class re extends c.Component{render(){return c.createElement("div",null,c.createElement("h2",null,"这是首页..."))}}function oe(){return c.useEffect((()=>{const e=JSON.parse(window.sessionStorage.user_info)._id;return _.createSocket(e).on("reply_private_chat",(e=>{console.log("接收的数据",e)})),()=>{console.log("组件卸载")}}),[]),c.createElement("div",{className:"App"},c.createElement(M,null),c.createElement(c.Fragment,null,c.createElement(h,null,c.createElement(p,{path:"/home",component:re}),c.createElement(p,{path:"/friends",component:q}),c.createElement(p,{path:"/message",component:le}),c.createElement(p,{path:"/profile",component:z}),c.createElement(g,{to:"/home"}))),c.createElement(C,null))}var ce="_Login_1tqig_2",ie="_title_1tqig_13",me="_log_1tqig_24",ue="_input_container_1tqig_38",he="_checkbox_1tqig_49",pe="_input_account_1tqig_53",ge="_input_password_1tqig_53",de="_btn_login_1tqig_78",Ee="_btn_register_1tqig_78";var _e="_register_container_6br3r_2",Se="_topBar_6br3r_13",Ie="_back_btn_6br3r_19",ke="_welcome_6br3r_30",fe="_register_input_6br3r_52",Ae="_confirm_btn_6br3r_97";class we extends c.Component{constructor(){super(...arguments),r(this,"handleRegister",(()=>{const e=this.accountElem.value,t=this.pwdElem.value,a=this.repwdElem.value,s=this.sexElem.value,n=this.ageElem.value;""===e?alert("请输入账号~"):""===t?alert("请输入密码~"):""===a?alert("请确认密码~"):""===n?alert("请输入年龄~"):/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)?/^[A-Za-z0-9]+$/.test(t)?t!==a?alert("两次输入的密码不一致~"):D({url:"/user/register",method:"post",data:{account:e,password:t,sex:s,age:n}}).then((t=>{t.data.isRegister&&(alert("注册成功!"),this.props.setAccount(e),this.clearRegisterData(),this.props.goToLogin())})).catch((e=>{console.log(e)})):alert("密码只能由数字和字母组成~"):alert("请输入正确的邮箱格式~")}))}componentDidMount(){}clearRegisterData(){this.accountElem.value="",this.pwdElem.value="",this.repwdElem.value="",this.sexElem.value="男",this.ageElem.value=""}render(){return c.createElement("div",{className:_e},c.createElement("h2",{className:Se},c.createElement("span",{className:Ie,onTouchEnd:this.props.goToLogin}),"注册"),c.createElement("div",{className:ke},c.createElement("div",null,c.createElement("h1",null,"Hi,欢迎加入！"),c.createElement("hr",null),c.createElement("p",null,"WebChat,一个在web网页上面的即时聊天应用")),c.createElement("img",{src:"./assets/Log.a5585a7e.jpg",alt:""})),c.createElement("div",{className:fe},c.createElement("ul",null,c.createElement("li",null,c.createElement("label",null,"邮箱"),c.createElement("input",{ref:e=>{this.accountElem=e},type:"text",placeholder:"输入邮箱作为账号"})),c.createElement("li",null,c.createElement("label",null,"密码"),c.createElement("input",{ref:e=>{this.pwdElem=e},type:"text",placeholder:"输入密码"})),c.createElement("li",null,c.createElement("label",null,"确认密码"),c.createElement("input",{ref:e=>{this.repwdElem=e},type:"text",placeholder:"请确认密码"})),c.createElement("li",null,c.createElement("label",null,"性别"),c.createElement("select",{ref:e=>{this.sexElem=e}},c.createElement("option",{value:"男"},"男"),c.createElement("option",{value:"女"},"女"))),c.createElement("li",null,c.createElement("label",null,"年龄"),c.createElement("input",{ref:e=>{this.ageElem=e},type:"number",placeholder:"输入年龄"})))),c.createElement("button",{className:Ae,onTouchEnd:this.handleRegister},"确认注册"))}}class ve extends c.Component{constructor(){super(...arguments),r(this,"state",{isShowRegister:!1,isRemember:!1}),r(this,"handleLogin",(()=>{const e=this.accountElem.value,t=this.passwordElem.value;/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)?(console.log("true"),""!==t?D({url:"/user/login",method:"post",data:{account:e,password:t}}).then((a=>{if(console.log(a),a.data.isLogin){alert("OK!");const{_id:s}=a.data.data;let{sessionStorage:n}=window;n.setItem("user_info",JSON.stringify(a.data.data)),this.state.isRemember?localStorage.setItem("user_login",JSON.stringify({_id:s,account:e,password:t})):localStorage.setItem("user_login",JSON.stringify({_id:s,account:e,password:""})),window.location.reload()}else alert("请检查账号和密码~")})):alert("你还没有输入密码~")):""==e?alert("请输入账号~"):alert("你的邮箱格式错误~"),console.log(e,t)})),r(this,"setAccount",(e=>{this.accountElem.value=e})),r(this,"goToLogin",(()=>{this.setState({isShowRegister:!1}),this.container.style.display="block"})),r(this,"goToRegister",(()=>{this.setState({isShowRegister:!0}),setTimeout((()=>{this.container.style.display="none"}),200)})),r(this,"changeRemember",(e=>{this.setState((e=>({isRemember:!e.isRemember})),(()=>{console.log(this.state.isRemember)}))}))}componentDidMount(){const{localStorage:e}=window;if(console.log(e.getItem("user_login")),e.getItem("user_login")){const t=JSON.parse(e.getItem("user_login"));this.accountElem.value=t.account,this.passwordElem.value=t.password}else console.log("没有读取到本地的登录信息...")}render(){return c.createElement(c.Fragment,null,this.state.isShowRegister?c.createElement(we,{setAccount:this.setAccount,goToLogin:this.goToLogin}):c.createElement(c.Fragment,null),c.createElement("div",{className:ce,ref:e=>{this.container=e}},c.createElement("h2",{className:ie},"WebChat"),c.createElement("div",{className:me}),c.createElement("h2",null,"Hi,欢迎登录!"),c.createElement("ul",{className:ue},c.createElement("li",null,c.createElement("input",{type:"text",ref:e=>{this.accountElem=e},className:pe,placeholder:"请输入邮箱账号"})),c.createElement("li",null,c.createElement("input",{type:"text",ref:e=>{this.passwordElem=e},className:ge,placeholder:"请输入密码"})),c.createElement("li",{className:he},c.createElement("input",{type:"checkbox",name:"remember",value:"0",onChange:this.changeRemember})," 记住密码"),c.createElement("li",null,c.createElement("button",{className:de,onTouchEnd:this.handleLogin},"登录")),c.createElement("li",null,c.createElement("button",{className:Ee,onTouchEnd:this.goToRegister},"注册")))))}}var be="";localStorage.user_login&&(be=JSON.parse(localStorage.user_login)._id);let{sessionStorage:Ce}=window;null!==Ce.getItem("user_info")?d.render(c.createElement(c.StrictMode,null,c.createElement(E,{basename:"/WebChat"},c.createElement(oe,null))),document.getElementById("root")):d.render(c.createElement(c.StrictMode,null,c.createElement(ve,null)),document.getElementById("root")),window.onload=function(){console.log("页面加载"),window.onunload=function(){console.log("页面刷新"),window.onbeforeunload=function(){console.log("页面关闭"),_.closeSocket(be)}}};
